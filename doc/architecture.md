## 3. アプリケーション構造定義書

本セクションは、「相次相続控除 計算シミュレーター」の技術的な構造について、ユーザーマニュアルに記載された機能とコンポーネントベースの設計思想に基づき解説します。

### 3.1. 設計思想と全体アーキテクチャ

本アプリケーションは、モダンなフロントエンド技術、特に**コンポーネントベース設計**と**一元的な状態管理**を中核思想として構築されています。これにより、複雑なUIと計算ロジックを疎結合に保ち、保守性と拡張性を確保しながら、リアルタイムでのインタラクティブな体験を実現します。

-   **コンポーネントベース設計**: UIを「人物カード」や「入力フォーム」といった自己完結した再利用可能な部品（コンポーネント）に分割しています。各コンポーネントは自身の表示と役割にのみ責任を持ち、アプリケーション全体への影響を最小限に抑えます。
-   **一元的な状態管理**: アプリケーション全体のデータ（人物情報、相続情報、計算結果など）を「ストア」と呼ばれる単一の信頼できる情報源（*Single Source of Truth*）で管理します。これにより、データの流れが予測可能になり、デバッグや機能追加が容易になります。

### 3.2. ディレクトリ構成案

ReactやVue.jsのようなモダンフレームワークを利用した場合の、標準的かつスケーラブルなディレクトリ構成案を以下に示します。責務の分離が明確になるよう設計されています。

src/
├── components/         # 再利用可能なUIコンポーネント
│   ├── canvas/         # 家系図描画関連
│   │   ├── FamilyTreeCanvas.tsx
│   │   ├── PersonNode.tsx
│   │   └── RelationshipLine.tsx
│   ├── panel/          # データ入力パネル関連
│   │   ├── InputPanel.tsx
│   │   ├── GlobalInfoForm.tsx
│   │   └── PersonDetailForm.tsx
│   └── ui/             # 汎用的なUI部品 (Button, Modalなど)
│       ├── Button.tsx
│       ├── Modal.tsx
│       ├── Tooltip.tsx
│       └── Badge.tsx
├── store/              # 状態管理 (Zustand, Redux Toolkitなど)
│   ├── index.ts        # ストアの初期化・設定
│   ├── familyTreeSlice.ts # 人物、関係性などの状態と更新ロジック
│   └── calculationSlice.ts # 計算結果と関連データの状態と更新ロジック
├── hooks/              # カスタムフック (再利用可能なロジック)
│   └── useCalculation.ts # 計算ロジックをコンポーネントから利用しやすくするフック
├── types/              # TypeScriptの型定義
│   ├── index.ts
│   ├── Person.ts       # 人物オブジェクトの型
│   └── Inheritance.ts  # 相続情報の型
├── utils/              # 共通ヘルパー関数
│   ├── calculation.ts  # 相次相続控除のコア計算ロジック
│   ├── date.ts         # 日付関連の処理 (経過年数計算など)
│   └── validation.ts   # 入力値のバリデーションロジック
├── constants/          # アプリケーション全体で利用する定数
│   └── templates.ts    # 家族構成テンプレートのデータ
├── App.tsx             # アプリケーションのルートコンポーネント
└── main.tsx            # アプリケーションのエントリーポイント
